{"ast":null,"code":"import * as XLSX from 'xlsx';\n\nconst readExcel = async (file, setItems) => {\n  const promise = new Promise((resolve, reject) => {\n    const fileReader = new FileReader();\n    fileReader.readAsArrayBuffer(file);\n\n    fileReader.onload = e => {\n      const bufferArray = e.target.result;\n      const wb = XLSX.read(bufferArray, {\n        type: \"buffer\"\n      });\n      const wsname = wb.SheetNames[0];\n      const ws = wb.Sheets[wsname];\n      const data = XLSX.utils.sheet_to_json(ws);\n      resolve(data);\n    };\n\n    fileReader.onerror = error => {\n      reject(error);\n    };\n  });\n  promise.then(d => {\n    setItems(d);\n  });\n};\n\nconst funcs = {\n  readExcel\n};\nexport default funcs;","map":{"version":3,"names":["XLSX","readExcel","file","setItems","promise","Promise","resolve","reject","fileReader","FileReader","readAsArrayBuffer","onload","e","bufferArray","target","result","wb","read","type","wsname","SheetNames","ws","Sheets","data","utils","sheet_to_json","onerror","error","then","d","funcs"],"sources":["/home/david/Desktop/workSpace/bots-dashboard/src/utils/utils.js"],"sourcesContent":["import * as XLSX from 'xlsx'; \n\nconst readExcel = async (file, setItems) => {\n    const promise = new Promise((resolve, reject) => {\n        const fileReader = new FileReader();\n        fileReader.readAsArrayBuffer(file);\n\n        fileReader.onload = (e) => {\n            const bufferArray = e.target.result;\n    \n            const wb = XLSX.read(bufferArray, { type: \"buffer\" });\n    \n            const wsname = wb.SheetNames[0];\n    \n            const ws = wb.Sheets[wsname];\n    \n            const data = XLSX.utils.sheet_to_json(ws);\n\n            resolve(data);\n    };\n\n        fileReader.onerror = (error) => {\n            reject(error);\n        };\n    });\n\n    promise.then((d) => {\n        setItems(d);\n    });\n};\n\nconst funcs = {\n    readExcel,\n}\n\nexport default funcs;"],"mappings":"AAAA,OAAO,KAAKA,IAAZ,MAAsB,MAAtB;;AAEA,MAAMC,SAAS,GAAG,OAAOC,IAAP,EAAaC,QAAb,KAA0B;EACxC,MAAMC,OAAO,GAAG,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;IAC7C,MAAMC,UAAU,GAAG,IAAIC,UAAJ,EAAnB;IACAD,UAAU,CAACE,iBAAX,CAA6BR,IAA7B;;IAEAM,UAAU,CAACG,MAAX,GAAqBC,CAAD,IAAO;MACvB,MAAMC,WAAW,GAAGD,CAAC,CAACE,MAAF,CAASC,MAA7B;MAEA,MAAMC,EAAE,GAAGhB,IAAI,CAACiB,IAAL,CAAUJ,WAAV,EAAuB;QAAEK,IAAI,EAAE;MAAR,CAAvB,CAAX;MAEA,MAAMC,MAAM,GAAGH,EAAE,CAACI,UAAH,CAAc,CAAd,CAAf;MAEA,MAAMC,EAAE,GAAGL,EAAE,CAACM,MAAH,CAAUH,MAAV,CAAX;MAEA,MAAMI,IAAI,GAAGvB,IAAI,CAACwB,KAAL,CAAWC,aAAX,CAAyBJ,EAAzB,CAAb;MAEAf,OAAO,CAACiB,IAAD,CAAP;IACP,CAZG;;IAcAf,UAAU,CAACkB,OAAX,GAAsBC,KAAD,IAAW;MAC5BpB,MAAM,CAACoB,KAAD,CAAN;IACH,CAFD;EAGH,CArBe,CAAhB;EAuBAvB,OAAO,CAACwB,IAAR,CAAcC,CAAD,IAAO;IAChB1B,QAAQ,CAAC0B,CAAD,CAAR;EACH,CAFD;AAGH,CA3BD;;AA6BA,MAAMC,KAAK,GAAG;EACV7B;AADU,CAAd;AAIA,eAAe6B,KAAf"},"metadata":{},"sourceType":"module"}