{"ast":null,"code":"var _jsxFileName = \"/home/david/Desktop/workSpace/bots-dashboard/src/pages/Phone.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport JsSIP from \"jssip\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SIP_USERNAME = \"200-dataocean\";\nconst SIP_PASSWORD = \"RjH2TV2s9s8FHSpz\";\nconst SIP_DOMAIN = \"webrtc.1com.co.il\";\nconst SIP_SERVER = `wss://${SIP_DOMAIN}/ws`;\n\nfunction Softphone() {\n  _s();\n\n  const [ua, setUa] = useState(null);\n  const [isRegistered, setIsRegistered] = useState(false);\n  const [isInCall, setIsInCall] = useState(false);\n  const [remoteStream, setRemoteStream] = useState(null);\n  useEffect(() => {\n    const socket = new JsSIP.WebSocketInterface(SIP_SERVER);\n    const configuration = {\n      sockets: [socket],\n      uri: `sip:${SIP_USERNAME}@${SIP_DOMAIN}`,\n      password: SIP_PASSWORD\n    };\n    const userAgent = new JsSIP.UA(configuration);\n    setUa(userAgent);\n    userAgent.on(\"registered\", data => {\n      console.log(\"SIP registered:\", data);\n      setIsRegistered(true);\n    });\n    userAgent.on(\"unregistered\", data => {\n      console.log(\"SIP unregistered:\", data);\n      setIsRegistered(false);\n    });\n    userAgent.on(\"registrationFailed\", data => {\n      console.log(\"SIP registration failed:\", data);\n      setIsRegistered(false);\n    });\n    userAgent.on(\"newRTCSession\", data => {\n      const session = data.session;\n      session.on(\"peerconnection\", data => {\n        const pc = data.peerconnection;\n        const remoteStream = new MediaStream();\n        pc.getReceivers().forEach(receiver => {\n          const track = receiver.track;\n\n          if (track) {\n            remoteStream.addTrack(track);\n          }\n        });\n        setRemoteStream(remoteStream);\n      });\n      session.on(\"ended\", () => {\n        console.log(\"SIP call ended\");\n        setIsInCall(false);\n        setRemoteStream(null);\n      });\n      setIsInCall(true);\n    });\n    userAgent.start();\n    return () => {\n      userAgent.stop();\n    };\n  }, []);\n\n  const handleCall = () => {\n    const options = {\n      mediaConstraints: {\n        audio: true,\n        video: false\n      }\n    };\n    const session = ua.call(`sip:${'user2'}@${SIP_DOMAIN}`, options);\n    console.log(session);\n  };\n\n  const handleHangup = () => {\n    const activeSession = ua.getActiveSession();\n\n    if (activeSession) {\n      activeSession.terminate();\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Softphone\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\"Status: \", isRegistered ? \"Registered\" : \"Not registered\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 13\n    }, this), !isInCall && /*#__PURE__*/_jsxDEV(\"button\", {\n      disabled: !isRegistered,\n      onClick: handleCall,\n      children: \"Call\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 17\n    }, this), isInCall && /*#__PURE__*/_jsxDEV(\"button\", {\n      disabled: !isRegistered,\n      onClick: handleHangup,\n      children: \"Hang up\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 17\n    }, this), remoteStream && /*#__PURE__*/_jsxDEV(\"audio\", {\n      autoPlay: true,\n      srcObject: remoteStream\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Softphone, \"FlckY08sffPt/oIrOILC2CDlSJo=\");\n\n_c = Softphone;\nexport default Softphone;\n\nvar _c;\n\n$RefreshReg$(_c, \"Softphone\");","map":{"version":3,"names":["React","useState","useEffect","JsSIP","SIP_USERNAME","SIP_PASSWORD","SIP_DOMAIN","SIP_SERVER","Softphone","ua","setUa","isRegistered","setIsRegistered","isInCall","setIsInCall","remoteStream","setRemoteStream","socket","WebSocketInterface","configuration","sockets","uri","password","userAgent","UA","on","data","console","log","session","pc","peerconnection","MediaStream","getReceivers","forEach","receiver","track","addTrack","start","stop","handleCall","options","mediaConstraints","audio","video","call","handleHangup","activeSession","getActiveSession","terminate"],"sources":["/home/david/Desktop/workSpace/bots-dashboard/src/pages/Phone.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport JsSIP from \"jssip\";\n\nconst SIP_USERNAME = \"200-dataocean\";\nconst SIP_PASSWORD = \"RjH2TV2s9s8FHSpz\";\nconst SIP_DOMAIN = \"webrtc.1com.co.il\";\nconst SIP_SERVER = `wss://${SIP_DOMAIN}/ws`;\n\nfunction Softphone() {\n    const [ua, setUa] = useState(null);\n    const [isRegistered, setIsRegistered] = useState(false);\n    const [isInCall, setIsInCall] = useState(false);\n    const [remoteStream, setRemoteStream] = useState(null);\n\n    useEffect(() => {\n        const socket = new JsSIP.WebSocketInterface(SIP_SERVER);\n        const configuration = {\n            sockets: [socket],\n            uri: `sip:${SIP_USERNAME}@${SIP_DOMAIN}`,\n            password: SIP_PASSWORD,\n        };\n        const userAgent = new JsSIP.UA(configuration);\n\n        setUa(userAgent);\n\n        userAgent.on(\"registered\", (data) => {\n            console.log(\"SIP registered:\", data);\n            setIsRegistered(true);\n        });\n\n        userAgent.on(\"unregistered\", (data) => {\n            console.log(\"SIP unregistered:\", data);\n            setIsRegistered(false);\n        });\n\n        userAgent.on(\"registrationFailed\", (data) => {\n            console.log(\"SIP registration failed:\", data);\n            setIsRegistered(false);\n        });\n\n        userAgent.on(\"newRTCSession\", (data) => {\n            const session = data.session;\n\n            session.on(\"peerconnection\", (data) => {\n                const pc = data.peerconnection;\n\n                const remoteStream = new MediaStream();\n                pc.getReceivers().forEach((receiver) => {\n                    const track = receiver.track;\n                    if (track) {\n                        remoteStream.addTrack(track);\n                    }\n                });\n                setRemoteStream(remoteStream);\n            });\n\n            session.on(\"ended\", () => {\n                console.log(\"SIP call ended\");\n                setIsInCall(false);\n                setRemoteStream(null);\n            });\n\n            setIsInCall(true);\n        });\n\n        userAgent.start();\n\n        return () => {\n            userAgent.stop();\n        };\n    }, []);\n\n    const handleCall = () => {\n        const options = {\n            mediaConstraints: { audio: true, video: false },\n        };\n        const session = ua.call(`sip:${'user2'}@${SIP_DOMAIN}`, options);\n        console.log(session);\n    };\n\n    const handleHangup = () => {\n        const activeSession = ua.getActiveSession();\n        if (activeSession) {\n            activeSession.terminate();\n        }\n    };\n\n    return (\n        <div>\n            <h1>Softphone</h1>\n            <div>Status: {isRegistered ? \"Registered\" : \"Not registered\"}</div>\n            <br />\n            {!isInCall && (\n                <button disabled={!isRegistered} onClick={handleCall}>\n                    Call\n                </button>\n            )}\n            {isInCall && (\n                <button disabled={!isRegistered} onClick={handleHangup}>\n                    Hang up\n                </button>\n            )}\n            {remoteStream && (\n                <audio autoPlay srcObject={remoteStream}></audio>\n            )}\n        </div>\n    );\n}\n\nexport default Softphone;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}